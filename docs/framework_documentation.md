# PyTradePath Framework Documentation

## Overview

PyTradePath is a comprehensive, self-contained framework for backtesting and algorithmic trading. It provides all the necessary components to develop, test, and analyze trading strategies without any external dependencies.

## Architecture

The framework follows an event-driven architecture with the following core components:

### 1. Event System
- **MarketEvent**: Represents new market data
- **SignalEvent**: Trading signals generated by strategies
- **OrderEvent**: Orders to be executed
- **FillEvent**: Confirmation of executed orders

### 2. Data Management
- **DataHandler**: Abstract base class for data providers
- **HistoricCSVDataHandler**: Reads historical data from CSV files
- **CSVDataProvider**: Data provider for CSV files
- **DatabaseDataProvider**: Data provider for SQLite databases
- **APIBasedDataProvider**: Data provider for API-based sources

### 3. Strategy Development
- **Strategy**: Abstract base class for trading strategies
- **BuyAndHoldStrategy**: Simple buy-and-hold strategy
- **MovingAverageCrossoverStrategy**: Dual moving average crossover strategy
- **RSIStrategy**: RSI mean-reversion strategy
- **AdvancedMLStrategy**: Machine learning-based strategy with technical indicators

### 4. Portfolio Management
- **Portfolio**: Abstract base class for portfolio management
- **NaivePortfolio**: Simple portfolio implementation
- **AdvancedPortfolio**: Enhanced portfolio with analytics

### 5. Execution Handling
- **ExecutionHandler**: Abstract base class for execution
- **SimulatedExecutionHandler**: Simulates order execution with commissions and slippage

### 6. Risk Management
- **RiskManager**: Abstract base class for risk management
- **NaiveRiskManager**: Simple risk controls
- **EnhancedRiskManager**: Advanced risk controls with position limits and drawdown limits
- **PositionSizer**: Abstract base class for position sizing
- **FixedPositionSizer**: Fixed quantity position sizing
- **KellyCriterionPositionSizer**: Kelly criterion-based position sizing
- **VolatilityPositionSizer**: Volatility-adjusted position sizing

### 7. Machine Learning
- **MLModel**: Abstract base class for ML models
- **SimpleLinearRegression**: Linear regression implementation
- **SimpleDecisionTree**: Decision tree classifier
- **FeatureEngineer**: Creates features from market data
- **ModelEvaluator**: Evaluates ML model performance

### 8. Optimization
- **ParameterOptimizer**: Optimizes strategy parameters
- **WalkForwardOptimizer**: Walk-forward optimization
- **MonteCarloOptimizer**: Monte Carlo optimization
- **BayesianOptimizer**: Bayesian optimization

### 9. Analytics
- **StatisticalAnalyzer**: Statistical analysis of trading data
- **TimeSeriesAnalyzer**: Time series analysis
- **RiskAnalyzer**: Risk metrics calculation
- **MarketRegimeAnalyzer**: Market regime detection
- **AttributionAnalyzer**: Performance attribution
- **StressTester**: Stress testing of strategies
- **MonteCarloSimulator**: Monte Carlo simulations

### 10. Performance Utilities
- **calculate_sharpe_ratio**: Sharpe ratio calculation
- **calculate_max_drawdown**: Maximum drawdown calculation
- **calculate_cagr**: Compound annual growth rate
- **calculate_sortino_ratio**: Sortino ratio calculation
- **calculate_calmar_ratio**: Calmar ratio calculation

### 11. Utilities
- **CacheManager**: Caching mechanism
- **Timer**: Timing utility
- **HashUtility**: Hashing utility

## Key Features

### Event-Driven Architecture
The framework uses an event-driven architecture to prevent lookahead bias and ensure realistic backtesting.

### Realistic Market Simulation
- Commission modeling
- Slippage simulation
- Liquidity considerations

### Comprehensive Risk Management
- Position sizing algorithms
- Stop-loss management
- Drawdown controls
- Position limits

### Machine Learning Integration
- Linear regression models
- Decision tree classifiers
- Feature engineering capabilities
- Model evaluation tools

### Parameter Optimization
- Grid search
- Random search
- Genetic algorithms
- Bayesian optimization
- Walk-forward analysis

### Performance Analysis
- Sharpe ratio
- Maximum drawdown
- CAGR
- Sortino ratio
- Calmar ratio
- Win rate
- Risk-adjusted returns

### Data Management
- Multiple data sources (CSV, database, API)
- Data validation
- Data cleaning
- Data transformation

## Usage Examples

### Simple Backtest
```python
from core.engine import BacktestingEngine
from core.data_handler import HistoricCSVDataHandler
from strategies.moving_average_crossover import MovingAverageCrossoverStrategy

# Create backtesting engine
engine = BacktestingEngine(
    data_handler=lambda: HistoricCSVDataHandler('data', ['AAPL']),
    strategy=lambda symbols: MovingAverageCrossoverStrategy(symbols, 10, 50),
    portfolio=lambda data_handler, events, initial_capital: NaivePortfolio(
        data_handler, events, initial_capital=initial_capital),
    execution_handler=lambda events: SimulatedExecutionHandler(events),
    symbol_list=['AAPL'],
    initial_capital=100000.0
)

# Run backtest
engine.run()
```

### Advanced ML Strategy
```python
from strategies.advanced_ml_strategy import AdvancedMLStrategy
from core.risk import KellyCriterionPositionSizer

# Create advanced strategy
strategy = AdvancedMLStrategy(['AAPL', 'GOOGL'], short_window=10, long_window=50, use_ml=True)

# Set position sizer
position_sizer = KellyCriterionPositionSizer(portfolio, win_rate=0.6, avg_win=0.1, avg_loss=0.05)
strategy.set_position_sizer(position_sizer)
```

### Parameter Optimization
```python
from core.optimization import ParameterOptimizer

# Define parameter grid
param_grid = {
    'short_window': [5, 10, 15],
    'long_window': [20, 50, 100]
}

# Create optimizer
optimizer = ParameterOptimizer(
    MovingAverageCrossoverStrategy,
    HistoricCSVDataHandler,
    ['AAPL']
)

# Run optimization
results = optimizer.optimize_grid(param_grid)
```

## Testing

The framework includes comprehensive unit tests for all components:

```bash
python tests/test_advanced_components.py
```

## Requirements

The framework is completely self-contained with no external dependencies. All mathematical and data operations are implemented using pure Python.

## License

This framework is provided for educational and research purposes.